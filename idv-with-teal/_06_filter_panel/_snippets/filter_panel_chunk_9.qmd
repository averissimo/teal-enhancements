# Demonstrate hierarchical filtering with parent-child relationships
hierarchical_demo <- teal::init(
  data = coupled_demo_data,
  modules = teal::modules(
    # Parent dataset view
    teal::modules(
      label = "ðŸ‘¤ Subject Level (Parent)",
      tm_t_summary(
        label = "Subject Summary",
        dataname = "ADSL",
        summarize_vars = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", c("AGE", "SEX", "ARM")),
            selected = c("AGE", "ARM"),
            multiple = TRUE
          )
        )
      )
    ),

    # Child dataset views
    teal::modules(
      label = "ðŸ“‹ Event Level (Children)",
      tm_g_distribution(
        label = "AE Distribution",
        dataname = "ADAE",
        dist_var = data_extract_spec(
          dataname = "ADAE",
          select = select_spec(
            choices = variable_choices("ADAE", "AEDECOD"),
            selected = "AEDECOD"
          )
        )
      ),
      tm_data_table(
        label = "Concomitant Medications",
        dataname = "ADCM"
      )
    )
  )
)

# Hierarchical behavior:
# - ADSL is the "parent" dataset (subject-level)
# - ADAE and ADCM are "child" datasets (event-level)
# - Filtering ADSL (parent) automatically filters ADAE and ADCM (children)
# - Filtering ADAE doesn't affect ADSL (child can't filter parent)
# - This maintains data integrity and logical relationships

if (interactive()) {
  shiny::shinyApp(hierarchical_demo$ui, hierarchical_demo$server)
}
