library(teal)
library(teal.modules.general)

# Step 1: Prepare the data
app_data <- teal_data(
  IRIS = iris,
  MTCARS = mtcars,
  code = "IRIS <- iris; MTCARS <- mtcars"
)

# Step 2: Define the modules
app_modules <- modules(
  tm_data_table(
    label = "Data Table",
    datanames = "all"
  ),
  tm_variable_browser(
    label = "Variable Browser",
    datanames = "all"
  ),
  tm_g_scatterplot(
    label = "Scatter Plot",
    x = data_extract_spec(
      dataname = "IRIS",
      select = select_spec(
        choices = variable_choices("IRIS", c("Sepal.Length", "Sepal.Width")),
        selected = "Sepal.Length"
      )
    ),
    y = data_extract_spec(
      dataname = "IRIS",
      select = select_spec(
        choices = variable_choices("IRIS", c("Petal.Length", "Petal.Width")),
        selected = "Petal.Length"
      )
    )
  )
)

# Step 3: Initialize the application
app <- init(
  data = app_data,
  modules = app_modules
)

# Step 4: Launch the application
if (interactive()) {
  shiny::shinyApp(app$ui, app$server)
} else {
  return(shiny::shinyApp(app$ui, app$server))
}
