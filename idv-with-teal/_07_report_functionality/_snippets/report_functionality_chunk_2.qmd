# Application specifically designed to demonstrate report preview capabilities
preview_demo <- teal::init(
  data = report_demo_data,
  modules = teal::modules(
    # Create a series of analyses for comprehensive report preview
    teal::modules(
      label = "ðŸ‘¥ Population Analysis",
      tm_data_table(
        label = "Subject Disposition",
        dataname = "ADSL"
      ),
      tm_t_summary(
        label = "Demographics Summary",
        dataname = "ADSL",
        summarize_vars = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", c("AGE", "SEX", "RACE")),
            selected = c("AGE", "SEX", "RACE"),
            multiple = TRUE
          )
        ),
        by_vars = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "ARM"),
            selected = "ARM"
          )
        )
      )
    ),

    teal::modules(
      label = "ðŸ“Š Exploratory Analysis",
      tm_g_distribution(
        label = "Age Distribution",
        dataname = "ADSL",
        dist_var = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "AGE"),
            selected = "AGE"
          )
        ),
        strata_var = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "ARM"),
            selected = "ARM"
          )
        )
      ),
      tm_g_scatterplot(
        label = "Baseline Characteristics",
        dataname = "ADSL",
        x = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "AGE"),
            selected = "AGE"
          )
        ),
        y = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "BMIBL"),
            selected = "BMIBL"
          )
        ),
        color_by = data_extract_spec(
          dataname = "ADSL",
          select = select_spec(
            choices = variable_choices("ADSL", "ARM"),
            selected = "ARM"
          )
        )
      )
    )
  ),
  title = "Clinical Study Analysis - Report Preview Demo"
)

# Report preview workflow:
# 1. Add multiple analyses to the report from different modules
# 2. Navigate to the "Report" tab to see preview
# 3. Review the complete report structure
# 4. Check content organization and flow
# 5. Verify all analyses are properly documented

if (interactive()) {
  shiny::shinyApp(preview_demo$ui, preview_demo$server)
}
